<!DOCTYPE html>
<!--[if IE 9]>         <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!--> <html>         <!--<![endif]-->
  <head>
  <title>Adding Cloud Provider Accounts to Cloud Manager | NetApp Cloud Docs</title>
  <meta charset="utf-8">
  <meta property="og:image" content="https://docs.netapp.com/occm/en/images/logo-tophat-social.png" />
  <meta property="og:image:alt" content="NetApp Logo" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="format-detection" content="telephone=no">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge,chrome=1">
  <meta http-equiv="encoding" content="utf-8">
  <meta http-equiv="nss-type" content="Product Documentation">
  <meta http-equiv="nss-subtype" content="User Guide">
  
  <meta http-equiv="nss-product" content="OnCommand"/>
  
  <meta name="description" content="If you want to deploy Cloud Volumes ONTAP in different cloud accounts, then you need to provide the required permissions to those accounts and then add the d...">
  <meta name="keywords" content=" permissions, aws, policy, iam, iam role, role, granting, policy, iam policy, iam user, access keys, arn, cloud provider accounts, aws, cloud provider profile, microsoft, azure, permissions, custom role, role, json, active directory, ad, service principal, key, tenant id, application key, application id, operator role, managed service identity, iam, operator, role, virtual machine">

  <!-- Icons -->
  <link rel="icon" href="/occm/en/images/favicon.ico" type="image/x-icon">

  <!-- RSS Feed -->
  
  <link rel="alternate" type="application/rss+xml" title="NetApp Cloud Docs" href="/occm/en/feed.xml">
  

  <!-- CSS Definitions: NetApp CSS should be defined after generic css -->

  <!-- Elastic Search -->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/searchkit/0.10.0/theme.css">

  <!-- LUCI CSS Content -->
  <link rel="stylesheet" href="/occm/en/common/css/esb.min.css">
  <link rel="stylesheet" href="/occm/en/common/css/netapp-library.min.css">
  <link rel="stylesheet" href="/occm/en/common/css/doc.css">
  <link rel="stylesheet" href="/occm/en/common/css/doc-components.css">

  <link rel="stylesheet" href='/occm/en/css/na-sidebar.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/na-search.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/clouddocs.css' type='text/css'>

  <!-- Font awesome seems to affect our GitHub Icon and generic "arrow box" for external links. -->
  <link rel="stylesheet" type="text/css" href="/occm/en/css/font-awesome.min.css">
  <!-- <link rel="stylesheet" href="/occm/en/css/customstyles.css"> -->
  <!-- Controls the shadow effect for search dropdown menu -->
  <link rel="stylesheet" href="/occm/en/css/boxshadowproperties.css">

  <!-- NetApp CSS controls the technical content -->
  <link rel='stylesheet' href='/occm/en/css/netapp.css' type='text/css'>

  

  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
  <!-- Used to import Promise for IE. Required for SearchKit -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bluebird/3.3.5/bluebird.min.js"></script>
  
    <script src='/occm/en/js/na-search.js'></script>
  

  
  <link rel='stylesheet' href='/occm/en/css/na-pagenav.css' type='text/css' id="pagenav-css">
  <script src='/occm/en/js/na-pagenav.js'></script>
  

  <link rel='stylesheet' href='/occm/en/css/prism.css' type='text/css'>
  <link rel='stylesheet' href='/occm/en/css/prism-netapp.css' type='text/css'>

  <script src='/occm/en/js/clouddocs.js'></script>
  <script src='/occm/en/js/s_code_impl.js'></script>
  <script src='/occm/en/js/jquery.navgoco.min.js'></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  <script src='/occm/en/js/toc.js'></script>
  <script src='/occm/en/js/customscripts.js'></script>

  <script>
      $(document).ready(function() {
          // Initialize navgoco with default options
          $("#mysidebar").navgoco({
              caretHtml: '',
              accordion: true,
              openClass: 'active', // open
              save: false, // leave false or nav highlighting doesn't work right
              cookie: {
                  name: 'navgoco',
                  expires: false,
                  path: '/'
              },
              slide: {
                  duration: 400,
                  easing: 'swing'
              }
          });

          $("#collapseAll").click(function(e) {
              e.preventDefault();
              $("#mysidebar").navgoco('toggle', false);
          });

          $("#expandAll").click(function(e) {
              e.preventDefault();
              $("#mysidebar").navgoco('toggle', true);
          });

      });

  </script>
  <script>
      $(function () {
          $('[data-toggle="tooltip"]').tooltip()
      })
  </script>
  <script>
      $(document).ready(function() {
          $("#tg-sb-link").click(function() {
              $("#tg-sb-sidebar").toggle();
              $("#tg-sb-content").toggleClass('col-md-9');
              $("#tg-sb-content").toggleClass('col-md-12');
              $("#tg-sb-icon").toggleClass('fa-toggle-on');
              $("#tg-sb-icon").toggleClass('fa-toggle-off');
          });
      });
  </script>

  <!-- Controls the i18n Browser Redirection -->
  <script>
    var siteLocales = [];
    
      siteLocales.push("zz");
    
      siteLocales.push("en");
    
      siteLocales.push("us-en");
    

    standardizeUrl(siteLocales, "clouddocs.netapp.com", "https://docs.netapp.com");
  </script>

  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-81697994-3"></script>
  <script>
  if (document.location.hostname === "docs.netapp.com") {
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-81697994-3');
  }
  </script>
</head>


  <body class="n-doc__component-detail">
    <a href="#n-main-content" class="visually-hidden">Skip to main content</a>
<div class="n-off-canvas-menu">
  <div class="n-off-canvas-menu__menu">
    <div class="n-off-canvas-menu__menu-inner">
      <div class="n-off-canvas-menu__property-title">NetApp Cloud Docs</div>
      <ul class="n-off-canvas-menu__property-navigation-list">
        <li class="n-off-canvas-menu__property-navigation-list-item ">
          <a href="https://docs.netapp.com/en/" class="n-off-canvas-menu__property-navigation-link">
            Home
          </a>
          <div class="n-off-canvas-menu__child-menu">
            <ul class="n-menu__list">

            </ul>
          </div>
        </li>
      </ul>

      <ul class="n-off-canvas-menu__global-navigation-list">
         <li class="n-off-canvas-menu__global-navigation-list-header">More From NetApp</li>
         <li class="n-off-canvas-menu__global-navigation-list-item"><a href="#" class="n-off-canvas-menu__global-navigation-link">Netapp.com</a></li>
      </ul>
    </div>
  </div>
</div>

    <div class="n-off-canvas-menu__content-wrap">
      <!-- Header -->
      <header>
  <!-- Top Hat -->
  <div class="n-top-hat">
    <div class="n-container">
      <div class="n-top-hat__cross-property-nav">
        <ul class="n-top-hat__list">
            <li class="n-top-hat__list-item">
              <a href="http://www.netapp.com" class="n-top-hat__link">NetApp.com</a>
            </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- Property Bar -->
  <div class="n-property-bar n-property-bar--v3">
    <div class="n-property-bar__inner-wrap">
      <div class="n-property-bar__menu-toggle">
        <a href="#" class="n-property-bar__menu-toggle-link"><span class="n-property-bar__menu-toggle-text">Menu</span><svg class="n-icon-bars n-property-bar__menu-toggle-icon" aria-labelledby="title">
          <title>bars</title>
          <use xlink:href="/occm/en/common/svg/sprite.svg#bars"></use>
        </svg></a>
      </div>
      <div class="n-property-bar__property-mark n-property-bar__property-mark--has-property-name">
        <a class="n-property-bar__property-link" href="https://docs.netapp.com/en/">
          <div class="n-property-bar__logo">
            <svg class="n-icon-netapp-mark n-property-bar__netapp-mark-icon" aria-labelledby="title">
              <title>netapp-mark</title>
              <use xlink:href="/occm/en/common/svg/sprite.svg#netapp-mark"></use>
            </svg>
            <svg viewBox="0 0 1008 181.537" class="n-property-bar__logo-svg" aria-labelledby="title">
              <title>NetApp</title>
              <use xlink:href="/occm/en/common/svg/sprite.svg#netapp-logo"></use>
            </svg>
          </div>
          <h2 class="n-property-bar__property-name">Cloud Docs</h2>
        </a>
      </div>

      <!-- NetApp Search Bar -->
      
      <div id="search-demo-container" class="n-property-bar__search">
        <div id="react-search"></div>
      </div>
      

      <div id="ie-i18n-menu" class="n-property-bar__utils">
        <ul class="n-property-navigation-bar__utils-list">
          <li class="n-property-navigation-bar__utils-list-item">
            <a href="#" class="n-property-navigation-bar__utils-link n-property-navigation-bar__nav-link n-property-navigation-bar__language-selector-toggle" data-menu-id="n-property-navigation-bar__menu--language-selector">
              <svg class="n-icon-globe n-globe__icon" aria-labelledby="title">
                <title>globe</title>
                <use xlink:href="/occm/en/common/svg/sprite.svg#globe"></use>
              </svg>
            </a>
          </li>
        </ul>
      </div>
      <!-- End NetApp Search Bar -->
    </div>

    <div class="n-property-bar__menus">
      <div id="n-property-navigation-bar__menu--language-selector" class="n-menu n-menu--v3">
        <div class="n-language-selector-menu">
          <div class="n-language-selector-menu__header">
            <span class="n-language-selector-menu__title">Select Your Language</span>
          </div>
          <ul class="n-menu__list">
            <li class="n-menu__list-column">
              <ul class="n-menu__list">
                <li class="n-menu__list-item n-menu__list-item--level-1">
                  <a href="/occm/us-en/" class="n-menu__header-text">English</a>
                </li>
              </ul>
            </li>
          </ul>
          <div class="menu__footer">
            <p>Current Language: en
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>


      <!-- Content -->
      <main role="main" id="n-main-content" class="n-main-content">
        <div class="n-container">
  <div class="n-row">
    <div class="n-doc n-doc__component-list">
      <!-- Sidebar Column -->
      
      <div class="col-md-3" >
          

<ul id="mysidebar" class="nav">
  

  
    <li><a href="index.html">Cloud Manager 3.6 docs</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Release notes</a>
      <ul>
        

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Cloud Manager</a>
      <ul>
        

  
    <li><a href="reference_new_occm.html">What's new</a></li>
  

  
    <li><a href="reference_issues.html">Known issues</a></li>
  

  
    <li><a href="reference_limitations.html">Known limitations</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="https://docs.netapp.com/us-en/cloud-volumes-ontap/" target="_blank">Cloud Volumes ONTAP</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Concepts</a>
      <ul>
        

  
    <li><a href="concept_overview.html">Product overview</a></li>
  

  
    <li><a href="concept_cloud_central.html">NetApp Cloud Central</a></li>
  

  
    <li><a href="concept_accounts_and_permissions.html">Accounts and permissions</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Storage</a>
      <ul>
        

  
    <li><a href="concept_storage.html">Overview</a></li>
  

  
    <li><a href="concept_data_tiering.html">Data tiering</a></li>
  

  
    <li><a href="concept_storage_management.html">Storage management</a></li>
  

  
    <li><a href="concept_worm.html">WORM storage</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">High-availability pairs</a>
      <ul>
        

  
    <li><a href="concept_ha.html">HA pairs in AWS</a></li>
  

  
    <li><a href="concept_ha_azure.html">HA pairs in Azure</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="concept_evaluating.html">Evaluating</a></li>
  

  
    <li><a href="concept_licensing.html">Licensing</a></li>
  

  
    <li><a href="concept_security.html">Security</a></li>
  

  
    <li><a href="concept_performance.html">Performance</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Getting started</a>
      <ul>
        

  
    <li><a href="reference_deployment_overview.html">Deployment overview</a></li>
  

  
    <li><a href="task_getting_started_aws.html">Getting started in AWS</a></li>
  

  
    <li><a href="task_getting_started_azure.html">Getting started in Azure</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Setting up Cloud Manager</a>
      <ul>
        

  
    <li class="active"><a href="task_adding_cloud_accounts.html">Adding Cloud Provider Accounts</a></li>
  

  
    <li><a href="task_installing_https_cert.html">Installing an HTTPS certificate</a></li>
  

  
    <li><a href="task_setting_up_users_tenants.html">Setting up users and tenants</a></li>
  

  
    <li><a href="task_setting_up_kms.html">Setting up the AWS KMS</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Networking requirements</a>
      <ul>
        

  
    <li><a href="reference_networking_cloud_manager.html">Cloud Manager</a></li>
  

  
    <li><a href="reference_networking_aws.html">Cloud Volumes ONTAP for AWS</a></li>
  

  
    <li><a href="task_setting_up_transit_gateway.html">Setting up an AWS transit gateway</a></li>
  

  
    <li><a href="reference_networking_azure.html">Cloud Volumes ONTAP for Azure</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Additional deployment options</a>
      <ul>
        

  
    <li><a href="reference_cloud_mgr_reqs.html">Cloud Manager host requirements</a></li>
  

  
    <li><a href="task_installing_linux.html">Installing Cloud Manager on a Linux host</a></li>
  

  
    <li><a href="task_launching_aws_mktp.html">Deploying Cloud Manager from the AWS Marketplace</a></li>
  

  
    <li><a href="task_launching_azure_mktp.html">Deploying Cloud Manager from the Azure Marketplace</a></li>
  

  
    <li><a href="task_installing_azure_gov.html">Intalling Cloud Manager in Azure Gov</a></li>
  

  
    <li><a href="task_installing_azure_germany.html">Installing Cloud Manager in Azure Germany</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Deploying Cloud Volumes ONTAP</a>
      <ul>
        

  
    <li><a href="reference_before.html">Before you begin</a></li>
  

  
    <li><a href="task_logging_in.html">Logging in to Cloud Manager</a></li>
  

  
    <li><a href="task_planning_your_config.html">Planning your configuration</a></li>
  

  
    <li><a href="task_deploying_otc_aws.html">Launching Cloud Volumes ONTAP in AWS</a></li>
  

  
    <li><a href="task_deploying_otc_azure.html">Launching Cloud Volumes ONTAP in Azure</a></li>
  

  
    <li><a href="task_registering.html">Registering pay-as-you-go systems</a></li>
  

  
    <li><a href="task_setting_up_ontap_cloud.html">Setting up Cloud Volumes ONTAP</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Provisioning storage</a>
      <ul>
        

  
    <li><a href="task_provisioning_storage.html">Creating volumes, aggregates, and LUNs</a></li>
  

  
    <li><a href="task_tiering.html">Tiering inactive data to object storage</a></li>
  

  
    <li><a href="task_connecting_kubernetes.html">Using Cloud Volumes ONTAP as persistent storage</a></li>
  

  
    <li><a href="task_encrypting_volumes.html">Encrypting volumes with NetApp Volume Encryption</a></li>
  

  
    <li><a href="task_managing_storage.html">Managing existing storage</a></li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Provisioning NFS volumes from the Volume View</a>
      <ul>
        

  
    <li><a href="task_changing_volume_view.html">Changing to the Volume View</a></li>
  

  
    <li><a href="task_provisioning_volume_view.html">Creating and mounting NFS volumes</a></li>
  

  
    <li><a href="task_managing_volume_view.html">Managing NFS volumes</a></li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Managing data across a hybrid cloud</a>
      <ul>
        

  
    <li><a href="task_discovering_ontap.html">Discovering and managing ONTAP clusters</a></li>
  

  
    <li><a href="task_replicating_data.html">Replicating data to and from the cloud</a></li>
  

  
    <li><a href="task_syncing_s3.html">Syncing data to AWS S3</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Administering Cloud Volumes ONTAP</a>
      <ul>
        

  
    <li><a href="task_connecting_to_otc.html">Connecting to Cloud Volumes ONTAP</a></li>
  

  
    <li><a href="task_updating_ontap_cloud.html">Updating software</a></li>
  

  
    <li><a href="task_modifying_ontap_cloud.html">Modifying system configurations</a></li>
  

  
    <li><a href="task_managing_state.html">Stopping and starting systems</a></li>
  

  
    <li><a href="task_monitoring_costs.html">Monitoring AWS costs</a></li>
  

  
    <li><a href="task_protecting_ransomware.html">Improving ransomware protection</a></li>
  

  
    <li><a href="task_adding_ontap_cloud.html">Adding existing systems</a></li>
  

  
    <li><a href="task_deleting_working_env.html">Deleting systems</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Administering Cloud Manager</a>
      <ul>
        

  
    <li><a href="task_updating_cloud_manager.html">Updating Cloud Manager</a></li>
  

  
    <li><a href="task_backing_up_restoring.html">Backing up and restoring</a></li>
  

  
    <li><a href="task_removing.html">Removing working environments</a></li>
  

  
    <li><a href="task_editing_users.html">Editing user accounts</a></li>
  

  
    <li><a href="task_configuring_proxy.html">Configuring proxy settings</a></li>
  

  
    <li><a href="task_renewing_cert.html">Renewing the HTTPS certificate</a></li>
  

  
    <li><a href="task_uninstalling.html">Uninstalling Cloud Manager</a></li>
  


      </ul>
    </li>
  

  
    <!-- Check Container -->
    <li class="subfolders">
      <a href="#">Reference</a>
      <ul>
        

  
    <li><a href="reference_integration_faq.html">FAQ for Cloud Central integration</a></li>
  

  
    <li><a href="https://docs.netapp.com/us-en/cloud-volumes-ontap/reference_supported_configs_95.html" target="_blank">Supported configurations for Cloud Volumes ONTAP</a></li>
  

  
    <li><a href="https://cloud.netapp.com/cloud-volumes-global-regions" target="_blank">Supported regions</a></li>
  

  
    <li><a href="reference_security_groups.html">Security group rules for AWS</a></li>
  

  
    <li><a href="reference_security_groups_azure.html">Security group rules for Azure</a></li>
  

  
    <li><a href="reference_apis.html">REST APIs</a></li>
  

  
    <li><a href="reference_permissions.html">Permissions</a></li>
  

  
    <li><a href="reference_default_configs.html">Default configurations</a></li>
  

  
    <li><a href="reference_user_roles.html">User roles</a></li>
  

  
    <li><a href="reference_additional_info.html">Related links</a></li>
  


      </ul>
    </li>
  

  
    <li><a href="reference_earlier_versions.html">Earlier versions</a></li>
  

  
    <li><a href="reference_legal_notices.html">Legal notices</a></li>
  


</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

      </div>
      

      <div class="n-doc__component-detail-content n-doc__component-detail-content--show-code">
        <!-- Begin of page container -->
        <article class="page-content">
          

<div class="n-doc__component-detail-heading-wrap">
  <h1 class="n-doc__component-detail-heading">Adding Cloud Provider Accounts to Cloud Manager
    <span>
      
        <a target="_blank" href="https://github.com/NetAppDocs/occm/blob/master/task_adding_cloud_accounts.adoc" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edit on GitHub</a>
        <a target="_blank" href="https://github.com/NetAppDocs/occm/issues/new?body=Page%3A%20[Adding Cloud Provider Accounts to Cloud Manager](https://docs.netapp.com/en/occm/task_adding_cloud_accounts.html)" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Request doc changes</a>
      
    </span>
  </h1>
</div>

<p class="page-details">

<time datetime="2018-12-05 15:34:17 +0000">12/05/2018</time>


<span>Contributors
  
  <a target="_blank" href="https://github.com/netapp-bcammett">
    <img  class="avatar avatar-small"
          alt="netapp-bcammett"
          width="20" height="20"
          src="https://avatars3.githubusercontent.com/u/18287750?v=4"
          style="border-radius: 50%;"/>
  </a>
  
</span>

</p>

<div id="preamble">
<div class="sectionbody">
<div class="paragraph lead">
<p>If you want to deploy Cloud Volumes ONTAP in different cloud accounts, then you need to provide the required permissions to those accounts and then add the details to Cloud Manager.</p>
</div>
<div class="paragraph">
<p>When you deploy Cloud Manager from Cloud Central, Cloud Manager automatically adds a <a href="concept_accounts_and_permissions.html">Cloud Provider Account</a> for the account in which you deployed Cloud Manager. An initial Cloud Provider Account is not added if you manually installed the Cloud Manager software on an existing system.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="aws">Setting up and adding AWS accounts to Cloud Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to deploy Cloud Volumes ONTAP in different AWS accounts, then you need to provide the required permissions to those accounts and then add the details to Cloud Manager. How you provide the permissions depends on whether you want to provide Cloud Manager with AWS keys or the ARN of a role in a trusted account.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#granting-permissions-when-providing-aws-keys">Granting permissions when providing AWS keys</a></p>
</li>
<li>
<p><a href="#granting-permissions-by-assuming-iam-roles-in-other-accounts">Granting permissions by assuming IAM roles in other accounts</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="granting-permissions-when-providing-aws-keys">Granting permissions when providing AWS keys</h3>
<div class="paragraph">
<p>If you want to provide Cloud Manager with AWS keys for an IAM user, then you need to grant the required permissions to that user. The Cloud Manager IAM policy defines the AWS actions and resources that Cloud Manager is allowed to use.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Download the Cloud Manager IAM policy from the <a href="https://mysupport.netapp.com/cloudontap/iampolicies" target="_blank" rel="noopener">Cloud Manager Policies page</a>.</p>
</li>
<li>
<p>From the IAM console, create your own policy by copying and pasting the text from the Cloud Manager IAM policy.</p>
<div class="paragraph">
<p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_create.html" target="_blank" rel="noopener">AWS Documentation: Creating IAM Policies</a></p>
</div>
</li>
<li>
<p>Attach the policy to an IAM role or an IAM user.</p>
<div class="ulist">
<ul>
<li>
<p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create.html" target="_blank" rel="noopener">AWS Documentation: Creating IAM Roles</a></p>
</li>
<li>
<p><a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-attach-detach.html" target="_blank" rel="noopener">AWS Documentation: Adding and Removing IAM Policies</a></p>
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The account now has the required permissions. <a href="#adding-aws-accounts-to-cloud-manager">You can now add it to Cloud Manager</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="granting-permissions-by-assuming-iam-roles-in-other-accounts">Granting permissions by assuming IAM roles in other accounts</h3>
<div class="paragraph">
<p>You can set up a trust relationship between the source AWS account in which you deployed the Cloud Manager instance and other AWS accounts by using IAM roles. You would then provide Cloud Manager with the ARN of the IAM roles from the trusted accounts.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Go to the target account where you want to deploy Cloud Volumes ONTAP and create an IAM role by selecting <strong>Another AWS account</strong>.</p>
<div class="paragraph">
<p>Be sure to do the following:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Enter the ID of the account where the Cloud Manager instance resides.</p>
</li>
<li>
<p>Attach the Cloud Manager IAM policy, which is available from the <a href="https://mysupport.netapp.com/cloudontap/iampolicies" target="_blank" rel="noopener">Cloud Manager Policies page</a>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_iam_create_role.gif" alt="A screenshot that shows the Create role page in the AWS IAM Console. Under Select type of trusted entity" width="Another AWS account is selected."></span></p>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>Go to the source account where the Cloud Manager instance resides and select the IAM role that is attached to the instance.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>Trust Relationships &gt; Edit trust relationship</strong>.</p>
</li>
<li>
<p>Add the "sts:AssumeRole" action and the ARN of the role that you created in the target account.</p>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">{
 "Version": "2012-10-17",
 "Statement": {
   "Effect": "Allow",
   "Action": "sts:AssumeRole",
   "Resource": "arn:aws:iam::ACCOUNT-B-ID:role/ACCOUNT-B-ROLENAME"
}
}</code></pre>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The account now has the required permissions. <a href="#adding-aws-accounts-to-cloud-manager">You can now add it to Cloud Manager</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="adding-aws-accounts-to-cloud-manager">Adding AWS accounts to Cloud Manager</h3>
<div class="paragraph">
<p>After you provide an AWS account with the required permissions, you can add the account to Cloud Manager. This enables you to launch Cloud Volumes ONTAP systems in that account.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>In the upper right of the Cloud Manager console, click the task drop-down list, and then select <strong>Cloud Provider Accounts</strong>.</p>
</li>
<li>
<p>Select <strong>AWS</strong>.</p>
</li>
<li>
<p>Choose whether you want to provide AWS keys or the ARN of a trusted IAM role.</p>
</li>
<li>
<p>Confirm that the policy requirements have been met and then click <strong>Add Account</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You can now switch to another account from the Details and Credentials page when creating a new working environment:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_accounts_switch_aws.gif" alt="A screenshot that shows selecting between Cloud Provider Accounts after clicking Switch Account in the Details &amp; Credentials page."></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="azure">Setting up and adding Azure accounts to Cloud Manager</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to deploy Cloud Volumes ONTAP in different Azure accounts, then you need to provide the required permissions to those accounts and then add details about the accounts to Cloud Manager.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#granting-azure-permissions-using-a-service-principal">Granting Azure permissions using a service principal</a></p>
</li>
<li>
<p><a href="#adding-azure-accounts-to-cloud-manager">Adding Azure accounts to Cloud Manager</a></p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="granting-azure-permissions-using-a-service-principal">Granting Azure permissions using a service principal</h3>
<div class="paragraph">
<p>Cloud Manager needs permissions to perform actions in Azure. You can grant the required permissions to an Azure account by creating and setting up a service principal in Azure Active Directory and by obtaining the Azure credentials that Cloud Manager needs.</p>
</div>
<div class="paragraph">
<div class="title">About this task</div>
<p>The following image depicts how Cloud Manager obtains permissions to perform operations in Azure. A service principal object, which is tied to one or more Azure subscriptions, represents Cloud Manager in Azure Active Directory and is assigned to a custom role that allows the required permissions.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/diagram_azure_authentication.png" alt="Conceptual image that shows Cloud Manager obtaining authentication and authorization from Azure Active Directory before it can make an API call. In Active Directory" width="the Cloud Manager Operator role defines permissions. It is tied to one or more Azure subscriptions and a service principal object that represents the Cloud Manger application."></span></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
The following steps use the new Azure portal. If you experience any issues, you should use the Azure classic portal.
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p><a href="#creating-a-custom-role-with-the-required-cloud-manager-permissions">Create a custom role with the required Cloud Manager permissions</a>.</p>
</li>
<li>
<p><a href="#creating-an-active-directory-service-principal">Create an Active Directory service principal</a>.</p>
</li>
<li>
<p><a href="#assigning-the-cloud-manager-operator-role-to-the-service-principal">Assign the custom Cloud Manager Operator role to the service principal</a>.</p>
</li>
</ol>
</div>
<div class="sect3">
<h4 id="creating-a-custom-role-with-the-required-cloud-manager-permissions">Creating a custom role with the required Cloud Manager permissions</h4>
<div class="paragraph">
<p>A custom role is required to provide Cloud Manager with the permissions that it needs to launch and manage Cloud Volumes ONTAP in Azure.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Download the <a href="https://mysupport.netapp.com/cloudontap/iampolicies" target="_blank" rel="noopener">Cloud Manager Azure policy</a>.</p>
</li>
<li>
<p>Modify the JSON file by adding Azure subscription IDs to the assignable scope.</p>
<div class="paragraph">
<p>You should add the ID for each Azure subscription from which users will create Cloud Volumes ONTAP systems.</p>
</div>
<div class="paragraph">
<p><strong>Example</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-json" data-lang="json">"AssignableScopes": [
"/subscriptions/d333af45-0d07-4154-943d-c25fbzzzzzzz",
"/subscriptions/54b91999-b3e6-4599-908e-416e0zzzzzzz",
"/subscriptions/398e471c-3b42-4ae7-9b59-ce5bbzzzzzzz"</code></pre>
</div>
</div>
</li>
<li>
<p>Use the JSON file to create a custom role in Azure.</p>
<div class="paragraph">
<p>The following example shows how to create a custom role using the Azure CLI 2.0:</p>
</div>
<div class="paragraph">
<p><strong>az role definition create --role-definition C:\Policy_for_cloud_Manager_Azure_3.6.1.json</strong></p>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You should now have a custom role called OnCommand Cloud Manager Operator.</p>
</div>
</div>
<div class="sect3">
<h4 id="creating-an-active-directory-service-principal">Creating an Active Directory service principal</h4>
<div class="paragraph">
<p>You must create an Active Directory service principal so Cloud Manager can authenticate with Azure Active Directory.</p>
</div>
<div class="paragraph">
<div class="title">Before you begin</div>
<p>You must have the appropriate permissions in Azure to create an Active Directory application and to assign the application to a role. For details, refer to <a href="https://azure.microsoft.com/en-us/documentation/articles/resource-group-create-service-principal-portal/" target="_blank" rel="noopener">Microsoft Azure Documentation: Use portal to create Active Directory application and service principal that can access resources</a>.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>From the Azure portal, open the <strong>Azure Active Directory</strong> service.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad.gif" alt="Shows the Active Directory service in Microsoft Azure."></span></p>
</div>
</li>
<li>
<p>In the menu, click <strong>App registrations</strong>.</p>
</li>
<li>
<p>Create the service principal:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Click <strong>New application registration</strong>.</p>
</li>
<li>
<p>Enter a name for the application, keep <strong>Web app / API</strong> selected, and then enter any URL—for example, <a href="http://url" class="bare">http://url</a></p>
</li>
<li>
<p>Click <strong>Create</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Modify the application to add the required permissions:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Select the created application.</p>
</li>
<li>
<p>Under Settings, click <strong>Required permissions</strong> and then click <strong>Add</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad_permissions.gif" alt="Shows the settings for an Active Directory application in Microsoft Azure and highlights the option to add required permissions for API access."></span></p>
</div>
</li>
<li>
<p>Click <strong>Select an API</strong>, select <strong>Windows Azure Service Management API</strong>, and then click <strong>Select</strong>.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad_api.gif" alt="Shows the API to select in Microsoft Azure when adding API access to the Active Directory application. The API is the Windows Azure Service Management API."></span></p>
</div>
</li>
<li>
<p>Click <strong>Access Azure Service Management as organization users</strong>, click <strong>Select</strong> and then click <strong>Done</strong>.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Create a key for the service principal:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Under Settings, click <strong>Keys</strong>.</p>
</li>
<li>
<p>Enter a description, select a duration, and then click <strong>Save</strong>.</p>
</li>
<li>
<p>Copy the key value.</p>
<div class="paragraph">
<p>You need to enter the key value when you add a Cloud Provider Account to Cloud Manager.</p>
</div>
</li>
<li>
<p>Click <strong>Properties</strong> and then copy the application ID for the service principal.</p>
<div class="paragraph">
<p>Similar to the key value, you need to enter the application ID in Cloud Manager when you add a Cloud Provider Account to Cloud Manager.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad_app_id.gif" alt="Shows the application ID for an Azure Active Directory service principal."></span></p>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Obtain the Active Directory tenant ID for your organization:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>In the Active Directory menu, click <strong>Properties</strong>.</p>
</li>
<li>
<p>Copy the Directory ID.</p>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_azure_ad_id.gif" alt="Shows the Active Directory properties in the Azure portal and the Directory ID that you need to copy."></span></p>
</div>
<div class="paragraph">
<p>Just like the application ID and application key, you must enter the Active Directory tenant ID when you add a Cloud Provider Account to Cloud Manager.</p>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You should now have an Active Directory service principal and you should have copied the application ID, the application key, and the Active Directory tenant ID. You need to enter this information in Cloud Manager when you add a Cloud Provider Account.</p>
</div>
</div>
<div class="sect3">
<h4 id="assigning-the-cloud-manager-operator-role-to-the-service-principal">Assigning the Cloud Manager Operator role to the service principal</h4>
<div class="paragraph">
<p>You must bind the service principal to one or more Azure subscriptions and assign it the Cloud Manager Operator role so Cloud Manager has permissions in Azure.</p>
</div>
<div class="paragraph">
<div class="title">About this task</div>
<p>If you want to deploy Cloud Volumes ONTAP from multiple Azure subscriptions, then you must bind the service principal to each of those subscriptions. Cloud Manager enables you to select the subscription that you want to use when deploying Cloud Volumes ONTAP.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>From the Azure portal, select <strong>Subscriptions</strong> in the left pane.</p>
</li>
<li>
<p>Select the subscription.</p>
</li>
<li>
<p>Click <strong>Access control (IAM)</strong> and then click <strong>Add</strong>.</p>
</li>
<li>
<p>Select the <strong>OnCommand Cloud Manager Operator</strong> role.</p>
</li>
<li>
<p>Search for the name of the application (you cannot find it in the list by scrolling).</p>
</li>
<li>
<p>Select the application, click <strong>Select</strong>, and then click <strong>OK</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>The service principal for Cloud Manager now has the required Azure permissions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="adding-azure-accounts-to-cloud-manager">Adding Azure accounts to Cloud Manager</h3>
<div class="paragraph">
<p>After you provide an Azure account with the required permissions, you can add the account to Cloud Manager. This enables you to launch Cloud Volumes ONTAP systems in that account.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>In the upper right of the Cloud Manager console, click the task drop-down list, and then select <strong>Cloud Provider Accounts</strong>.</p>
</li>
<li>
<p>Select <strong>Azure</strong>.</p>
</li>
<li>
<p>Enter information about the Azure Active Directory service principal that grants the required permissions.</p>
</li>
<li>
<p>Confirm that the policy requirements have been met and then click <strong>Add Account</strong>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>You can now switch to another account from the Details and Credentials page when creating a new working environment:</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_accounts_switch_azure.gif" alt="A screenshot that shows selecting between Cloud Provider Accounts after clicking Switch Account in the Details &amp; Credentials page."></span></p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="associating-additional-azure-subscriptions-with-a-managed-service-identity">Associating additional Azure subscriptions with a Managed Service Identity</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Cloud Manager enables you to choose the Azure account and subscription in which you want to deploy Cloud Volumes ONTAP. You can&#8217;t select a different Azure subscription for the Managed Service Identity profile unless you associate the Managed Service Identity with those subscriptions.</p>
</div>
<div class="paragraph">
<div class="title">About this task</div>
<p>A Managed Service Identity is the initial <a href="concept_accounts_and_permissions.html">Cloud Provider Account</a> when you deploy Cloud Manager from NetApp Cloud Central. When you deployed Cloud Manager, Cloud Central created the OnCommand Cloud Manager Operator role and assigned it to the Cloud Manager virtual machine.</p>
</div>
<div class="olist arabic">
<div class="title">Steps</div>
<ol class="arabic">
<li>
<p>Log in to the Azure portal.</p>
</li>
<li>
<p>Open the <strong>Subscriptions</strong> service and then select the subscription in which you want to deploy Cloud Volumes ONTAP systems.</p>
</li>
<li>
<p>Click <strong>Access control (IAM)</strong>.</p>
</li>
<li>
<p>Click <strong>Add</strong> and then add the permissions:</p>
<div class="ulist">
<ul>
<li>
<p>Select the <strong>OnCommand Cloud Manager Operator</strong> role.</p>
</li>
<li>
<p>Assign access to a <strong>Virtual Machine</strong>.</p>
</li>
<li>
<p>Select the subscription in which the Cloud Manager virtual machine was created.</p>
</li>
<li>
<p>Select the Cloud Manager virtual machine.</p>
</li>
<li>
<p>Click <strong>Save</strong>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>Repeat these steps for additional subscriptions.</p>
</li>
</ol>
</div>
<div class="paragraph">
<div class="title">Result</div>
<p>When you create a new working environment, you should now have the ability to select from multiple Azure subscriptions for the Managed Service Identity profile.</p>
</div>
<div class="paragraph">
<p><span class="image"><img src="./media/screenshot_accounts_switch_azure_subscription.gif" alt="A screenshot that shows the ability to select multiple Azure subscriptions when selecting a Microsoft Azure Provider Account."></span></p>
</div>
</div>
</div>

        </article>
        <!-- Page Container -->
      </div>

      
      <div class="page-nav-container">
        <nav class="page-nav-fixed">
          <div class="page-nav-title">On this page:</div>
          <ul class="page-nav-inner" id="page-menu"></ul>
        </nav>
      </div>
      

    </div>
  </div>
</div>

      </main>

      <!-- Footer -->
      
      <footer class="n-footer n-footer--v1" style="border-top: solid 10px #DFDFDF;">
        <div class="n-footer__bottom">
          <div class="n-container">
            <div class="n-footer__bottom-left">
              <div class="n-footer__copyright">
                  <a href="//www.netapp.com/us/legal/copyright.aspx" class="n-footer__copyright-link">© 2019 NetApp, Inc.</a>
              </div>
              <div class="n-footer__copyright">
                <a href="https://library.netapp.com/ecm/ecm_download_file/ECMLP2848669" class="n-footer__copyright-link">Notice</a>
              </div>
              <div class="n-footer__copyright">
                <a href="//www.netapp.com/us/legal/index.aspx" class="n-footer__copyright-link">Legal</a>
              </div>
              <div class="n-footer__social-links n-footer__copyright">
                <ul class="n-footer__social-link-list">
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-blog" href="http://blog.netapp.com" target="_blank" title="blog" alt="blog">
                      <span class="n-footer__social-link-text">blog</span>
                      <svg class="n-icon-blog n-footer__social-link-icon" aria-labelledby="title">
                        <title>blog@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#blog"></use>
                      </svg>
                    </a>
                  </li>
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-community" href="http://community.netapp.com/" target="_blank" title="community" alt="community">
                      <span class="n-footer__social-link-text">community</span>
                      <svg class="n-icon-twitter n-footer__social-link-icon" aria-labelledby="title">
                        <title>community@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#comments"></use>
                      </svg>
                    </a>
                  </li>

                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-twitter" href="https://twitter.com/netappdoc" target="_blank" title="twitter" alt="twitter">
                      <span class="n-footer__social-link-text">twitter</span>
                      <svg class="n-icon-twitter n-footer__social-link-icon" aria-labelledby="title">
                        <title>twitter@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#twitter"></use>
                      </svg>
                    </a>
                  </li>
                  <li class="n-footer__social-link-list-item">
                    <a class="n-footer__social-link" data-ntap-social="follow-youtube" href="https://www.youtube.com/user/NetAppTechCommTV/" target="_blank" title="youtube" alt="youtube">
                      <span class="n-footer__social-link-text">youtube</span>
                      <svg class="n-icon-youtube n-footer__social-link-icon" aria-labelledby="title">
                        <title>youtube@</title>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="/occm/en/common/svg/sprite.svg#youtube"></use>
                      </svg>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
            <div class="n-footer__bottom-right">
              <div class="n-footer__copyright">
                <a href="https://docs.netapp.com/en/contribute/" class="n-footer__copyright-link">Contribute</a>
              </div>
              <div class="n-footer__copyright">
                <a target="_self" class="n-footer__copyright-link" href="javascript:netapp_mailto()">Email your feedback</a>
              </div>
            </div>
          </div>
        </div>
      </footer>

    </div>

    <script src="/occm/en/common/js/components.js"></script>
    <script src="/occm/en/common/js/doc-components.js"></script>

    <!-- Elasticsearch JS -->
    <script type="text/javascript" src='/occm/en/js/bundle.js'></script>

    <!-- Syntax Highlighting -->
    <script type="text/javascript" src='/occm/en/js/prism.js'></script>
    <script type="text/javascript" src='/occm/en/js/prism-curl.js'></script>

  </body>

  
</html>
